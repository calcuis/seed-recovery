# seed-recovery
**Recover a lost seed (used wallet with multiple missing words)**

The provided Python code implements functionality related to seed phrases, key derivation, and address generation.

Let's go through the code and understand each component:

The `seed_phrase` variable is assigned the user input obtained through the `input()` function. It prompts the user to input their seed phrase as words separated by spaces, with "?" representing the missing word(s). The seed phrase is converted to lowercase.

The required libraries are imported: `itertools`, `hashlib`, requests, and `pycoin.symbols.btc.network` from the `pycoin` package, specifically for bitcoin network operations.

The `calc_key(seed_phrase, passphrase)` function takes a seed phrase and an optional passphrase as input. It uses the `pbkdf2_hmac` function from the `hashlib` module to derive a master key based on the seed phrase and passphrase. The `network.keys.bip32_seed()` method from the pycoin library is then used to generate the master key object. Finally, the master key is returned.

The `gen_address(derivation_path, master_key)` function generates a cryptocurrency address based on a given derivation path and master key. It first obtains the subkey by using the `subkey_for_path()` method of the master key object. Then, it calculates the hash160 value of the subkey with the `hash160()` method. Depending on the derivation path's prefix, different address generation methods are used for P2PKH (Pay-to-Public-Key-Hash) and P2SH (Pay-to-Script-Hash) addresses. The address is returned.

The `address_usage(address_list)` function checks the usage and balance of a list of cryptocurrency addresses. It takes a list of addresses as input and constructs a URL to query the blockchain.info API for address information. The `requests.get()` method is used to fetch the data. If any address in the list has a non-zero balance, its details (such as final balance, total received, and number of transactions) are printed, and the address is returned. Otherwise, an empty string is returned.

The `phrase_usage(seed_phrase_list, passphrase, derivation_path)` function is the main driver function. It takes a list of seed phrases (obtained from the `get_possible()` function explained later), an optional passphrase, and a list of derivation paths as input. It iterates over the seed phrases in chunks based on the maximum address limit. For each chunk, it calculates the master keys using the `calc_key()` function, generates addresses for different derivation paths using the `gen_address()` function, and checks the address usage with the `address_usage()` function. If a non-zero balance is found, the corresponding seed phrase is printed, and the loop breaks. Finally, it prints "DONE!" when the process is complete.

The `get_possible(seed_phrase)` function takes a seed phrase as input and generates all possible variations of the seed phrase by considering the missing word(s) represented by "?". It reads a file named "english.txt," which contains a list of English words (one word per line). The function converts the seed phrase to a list of words, replaces the missing word(s) with their index in the word list, and then converts the indices to binary representation. It calculates the number of missing bits and generates possible combinations of binary strings that represent missing bits and their corresponding checksums. It combines the binary representations with the existing seed phrase binary, calculates the checksum for each combination, and generates all possible seed phrases. The function returns a tuple of possible seed phrases.

Finally, the `phrase_usage(get_possible(seed_phrase))` line calls the `phrase_usage()` function with the possible seed phrases generated by the `get_possible()` function as input. This initiates the process of deriving master keys, generating addresses, and checking their usage for the given seed phrase.

Please note that this part is specifically tailored for the bitcoin network and relies on external resources such as the "english.txt" word list file (bitcoin github) and the blockchain.info API (check transaction record).

**References**

https://www.blockplate.com/blogs/blockplate/find-a-used-seed-phrase-with-multiple-missing-words-with-code (original idea from this article)

https://github.com/bitcoin/bips/blob/master/bip-0039/english.txt (bip39 wordlist from bitcoin github)
